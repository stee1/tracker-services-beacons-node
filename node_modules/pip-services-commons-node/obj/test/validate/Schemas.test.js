"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var assert = require('chai').assert;
var async = require('async');
var TestObject_1 = require("./TestObject");
var Schema_1 = require("../../src/validate/Schema");
var ObjectSchema_1 = require("../../src/validate/ObjectSchema");
var ArraySchema_1 = require("../../src/validate/ArraySchema");
var MapSchema_1 = require("../../src/validate/MapSchema");
var TypeCode_1 = require("../../src/convert/TypeCode");
suite('SchemasTest', function () {
    test('Test empty schema', function (done) {
        var schema = new ObjectSchema_1.ObjectSchema();
        var results = schema.validate(null);
        assert.equal(results.length, 0);
        done();
    });
    test('Test required', function (done) {
        var schema = new Schema_1.Schema().makeRequired();
        var results = schema.validate(null);
        assert.equal(results.length, 1);
        done();
    });
    test('Test unexpected', function (done) {
        var schema = new ObjectSchema_1.ObjectSchema();
        var obj = new TestObject_1.TestObject();
        var results = schema.validate(obj);
        assert.equal(results.length, 10);
        done();
    });
    test('Test optional properties', function (done) {
        var schema = new ObjectSchema_1.ObjectSchema()
            .withOptionalProperty("intField")
            .withOptionalProperty("stringProperty")
            .withOptionalProperty("nullProperty")
            .withOptionalProperty("intArrayProperty")
            .withOptionalProperty("stringListProperty")
            .withOptionalProperty("mapProperty")
            .withOptionalProperty("subObjectProperty")
            .withOptionalProperty("subArrayProperty");
        var obj = new TestObject_1.TestObject();
        var results = schema.validate(obj);
        assert.equal(results.length, 2);
        done();
    });
    test('Test required properties', function (done) {
        var schema = new ObjectSchema_1.ObjectSchema()
            .withRequiredProperty("privateField")
            .withRequiredProperty("privateProperty")
            .withRequiredProperty("intField")
            .withRequiredProperty("stringProperty")
            .withRequiredProperty("nullProperty")
            .withRequiredProperty("intArrayProperty")
            .withRequiredProperty("stringListProperty")
            .withRequiredProperty("mapProperty")
            .withRequiredProperty("subObjectProperty")
            .withRequiredProperty("subArrayProperty");
        var obj = new TestObject_1.TestObject();
        obj.subArrayProperty = null;
        var results = schema.validate(obj);
        assert.equal(results.length, 2);
        done();
    });
    test('Test types', function (done) {
        var schema = new ObjectSchema_1.ObjectSchema()
            .withRequiredProperty("privateField")
            .withRequiredProperty("privateProperty")
            .withRequiredProperty("intField", TypeCode_1.TypeCode.Long)
            .withRequiredProperty("stringProperty", TypeCode_1.TypeCode.String)
            .withOptionalProperty("nullProperty", TypeCode_1.TypeCode.Object)
            .withRequiredProperty("intArrayProperty", TypeCode_1.TypeCode.Array)
            .withRequiredProperty("stringListProperty", TypeCode_1.TypeCode.Array)
            .withRequiredProperty("mapProperty", TypeCode_1.TypeCode.Map)
            .withRequiredProperty("subObjectProperty", TypeCode_1.TypeCode.Map)
            .withRequiredProperty("subArrayProperty", TypeCode_1.TypeCode.Array);
        var obj = new TestObject_1.TestObject();
        var results = schema.validate(obj);
        assert.equal(results.length, 0);
        done();
    });
    test('Test sub schema', function (done) {
        var sunSchema = new ObjectSchema_1.ObjectSchema()
            .withRequiredProperty("id", TypeCode_1.TypeCode.String)
            .withRequiredProperty("floatField", TypeCode_1.TypeCode.Double)
            .withOptionalProperty("nullProperty", TypeCode_1.TypeCode.Map);
        var schema = new ObjectSchema_1.ObjectSchema()
            .withRequiredProperty("privateField")
            .withRequiredProperty("privateProperty")
            .withRequiredProperty("intField", TypeCode_1.TypeCode.Long)
            .withRequiredProperty("stringProperty", TypeCode_1.TypeCode.String)
            .withOptionalProperty("nullProperty", TypeCode_1.TypeCode.Object)
            .withRequiredProperty("intArrayProperty", TypeCode_1.TypeCode.Array)
            .withRequiredProperty("stringListProperty", TypeCode_1.TypeCode.Array)
            .withRequiredProperty("mapProperty", TypeCode_1.TypeCode.Map)
            .withRequiredProperty("subObjectProperty", sunSchema)
            .withRequiredProperty("subArrayProperty", TypeCode_1.TypeCode.Array);
        var obj = new TestObject_1.TestObject();
        var results = schema.validate(obj);
        assert.equal(results.length, 0);
        done();
    });
    test('Test array and map schemas', function (done) {
        var sunSchema = new ObjectSchema_1.ObjectSchema()
            .withRequiredProperty("id", TypeCode_1.TypeCode.String)
            .withRequiredProperty("floatField", TypeCode_1.TypeCode.Double)
            .withOptionalProperty("nullProperty", TypeCode_1.TypeCode.Map);
        var schema = new ObjectSchema_1.ObjectSchema()
            .withRequiredProperty("privateField")
            .withRequiredProperty("privateProperty")
            .withRequiredProperty("intField", TypeCode_1.TypeCode.Long)
            .withRequiredProperty("stringProperty", TypeCode_1.TypeCode.String)
            .withOptionalProperty("nullProperty", TypeCode_1.TypeCode.Object)
            .withRequiredProperty("intArrayProperty", new ArraySchema_1.ArraySchema(TypeCode_1.TypeCode.Long))
            .withRequiredProperty("stringListProperty", new ArraySchema_1.ArraySchema(TypeCode_1.TypeCode.String))
            .withRequiredProperty("mapProperty", new MapSchema_1.MapSchema(null, null, TypeCode_1.TypeCode.String, TypeCode_1.TypeCode.Long))
            .withRequiredProperty("subObjectProperty", sunSchema)
            .withRequiredProperty("subArrayProperty", TypeCode_1.TypeCode.Array);
        var obj = new TestObject_1.TestObject();
        var results = schema.validate(obj);
        assert.equal(results.length, 0);
        done();
    });
});
//# sourceMappingURL=Schemas.test.js.map